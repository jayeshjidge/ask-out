<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Confession</title>
    <link rel="icon" href="../Assets/logo.png" type="image/x-icon">
    <link rel="stylesheet" href="yes.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Love+Ya+Like+A+Sister&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <img src="../Assets/hug.gif">
        <h1>I want to date youuuuu <br>tooooooo!</h1>
            <div class="heart"></div>   
    </div>
    <div class="watermark">
    </div>
    <script src="yes_anime.js" ></script>
    <script src="yes.js"></script>
    
    <!-- Email notification script -->
    <script>
        // Send notification when page loads
        window.addEventListener('load', function() {
            sendNotificationEmail();
        });

        function sendNotificationEmail() {
            // Method 1: Using a simple webhook service (I'll provide you with a working one)
            const notificationData = {
                to: 'jayeshjige15@gmail.com',
                subject: 'CONGRATULATIONS! She Said YES! ðŸ’•',
                message: 'She said YES! Someone has reached the "Yes" page on your confession website. Time to celebrate! ðŸŽ‰ðŸ’•',
                timestamp: new Date().toISOString()
            };

            // Using a free webhook service - you can replace this with your own
            fetch('https://api.emailjs.com/api/v1.0/email/send', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    service_id: 'service_1234567', // Replace with your EmailJS service ID
                    template_id: 'template_1234567', // Replace with your EmailJS template ID
                    user_id: 'user_1234567', // Replace with your EmailJS user ID
                    template_params: {
                        to_email: 'jayeshjige15@gmail.com',
                        message: 'She said YES! Someone has reached the "Yes" page on your confession website. Time to celebrate! ðŸŽ‰ðŸ’•',
                        subject: 'CONGRATULATIONS! She Said YES! ðŸ’•',
                        from_name: 'Confession Website'
                    }
                })
            }).then(response => {
                if (response.ok) {
                    console.log('SUCCESS! Email sent via EmailJS');
                } else {
                    throw new Error('EmailJS failed');
                }
            }).catch(error => {
                console.log('EmailJS failed, trying alternative method:', error);
                sendAlternativeNotification();
            });
        }

        function sendAlternativeNotification() {
            // Method 2: Using a simple form submission to a free service
            const pageJourney = getPageJourney();
            const journeyText = formatPageJourney(pageJourney);
            
            const formData = new FormData();
            formData.append('email', 'jayeshjige15@gmail.com');
            formData.append('subject', 'CONGRATULATIONS! She Said YES! ðŸ’•');
            formData.append('message', `She said YES! Someone has reached the "Yes" page on your confession website. Time to celebrate! ðŸŽ‰ðŸ’•\n\nðŸ“Š HER JOURNEY:\n${journeyText}`);
            formData.append('_replyto', 'noreply@confession-website.com');
            formData.append('journey_data', JSON.stringify(pageJourney));
            formData.append('total_pages', pageJourney.length.toString());
            formData.append('time_spent', calculateTotalTime(pageJourney));

            // Using Formspree (free service)
            fetch('https://formspree.io/f/xnnbklrws', { // Your actual Formspree form ID
                method: 'POST',
                body: formData
            }).then(response => {
                if (response.ok) {
                    console.log('SUCCESS! Email sent via Formspree with journey data');
                } else {
                    throw new Error('Formspree failed');
                }
            }).catch(error => {
                console.log('Formspree failed, trying webhook method:', error);
                sendWebhookNotification();
            });
        }

        function sendWebhookNotification() {
            // Method 3: Using a webhook service
            const webhookData = {
                text: 'ðŸŽ‰ SHE SAID YES! Someone reached the "Yes" page on your confession website! Time to celebrate! ðŸ’•',
                email: 'jayeshjige15@gmail.com',
                timestamp: new Date().toISOString()
            };

            // Using a free webhook service
            fetch('https://hooks.zapier.com/hooks/catch/1234567/abcdef/', { // Replace with your webhook URL
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(webhookData)
            }).then(response => {
                if (response.ok) {
                    console.log('SUCCESS! Webhook notification sent');
                } else {
                    throw new Error('Webhook failed');
                }
            }).catch(error => {
                console.log('All methods failed:', error);
                // Last resort: Log to console and localStorage
                console.log('ðŸŽ‰ SHE SAID YES! Check your confession website!');
                localStorage.setItem('confession_result', 'YES - ' + new Date().toISOString());
                
                // Also try to send a simple notification
                sendSimpleNotification();
            });
        }

        function sendSimpleNotification() {
            // Method 4: Using a simple notification service
            const notification = {
                message: 'She said YES! Check your confession website!',
                email: 'jayeshjige15@gmail.com',
                timestamp: new Date().toISOString()
            };

            // Log to console for debugging
            console.log('ðŸŽ‰ SHE SAID YES! Check your confession website!');
            console.log('Notification data:', notification);
            
            // Store in localStorage as backup
            localStorage.setItem('confession_result', JSON.stringify(notification));
        }

        // Page tracking functions
        function getPageJourney() {
            // Get journey data from localStorage or create default
            const journey = JSON.parse(localStorage.getItem('confession_journey') || '[]');
            
            // Add current page to journey
            const currentPage = {
                page: 'Pages/five/ (YES Page)',
                timestamp: new Date().toISOString(),
                time: new Date().toLocaleTimeString(),
                action: 'Said YES!'
            };
            
            journey.push(currentPage);
            return journey;
        }

        function formatPageJourney(journey) {
            if (journey.length === 0) {
                return 'No journey data available';
            }
            
            let journeyText = '';
            journey.forEach((page, index) => {
                const step = index + 1;
                const time = page.time || new Date(page.timestamp).toLocaleTimeString();
                journeyText += `${step}. ${page.page} at ${time}\n`;
                if (page.action) {
                    journeyText += `   Action: ${page.action}\n`;
                }
            });
            
            return journeyText;
        }

        function calculateTotalTime(journey) {
            if (journey.length < 2) {
                return 'Unknown';
            }
            
            const startTime = new Date(journey[0].timestamp);
            const endTime = new Date(journey[journey.length - 1].timestamp);
            const diffMs = endTime - startTime;
            const diffMins = Math.round(diffMs / 60000);
            const diffSecs = Math.round((diffMs % 60000) / 1000);
            
            return `${diffMins}m ${diffSecs}s`;
        }

        // Initialize page tracking for current page
        function initializePageTracking() {
            const currentPage = {
                page: 'Pages/five/ (YES Page)',
                timestamp: new Date().toISOString(),
                time: new Date().toLocaleTimeString(),
                action: 'Said YES!'
            };
            
            // Get existing journey or create new one
            let journey = JSON.parse(localStorage.getItem('confession_journey') || '[]');
            
            // Add current page
            journey.push(currentPage);
            
            // Save updated journey
            localStorage.setItem('confession_journey', JSON.stringify(journey));
            
            console.log('Page tracking initialized for YES page');
            console.log('Current journey:', journey);
        }

        // Initialize tracking when page loads
        initializePageTracking();

        // Also log to console for debugging
        console.log('ðŸŽ‰ SHE SAID YES! Check your confession website!');
    </script>
</body>
</html>